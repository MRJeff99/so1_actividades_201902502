/*Auto-Tagger.js*/
(function(){{var at_amazon_locale_map={"CA":"ca","CN":"cn","IN":"in","DE":"de","FR":"fr","GB":"co.uk","JP":"co.jp","US":"com","IT":"it","ES":"es"};var at_orgUnit={"ca":"15","cn":"28","in":"31","de":"3","fr":"8","co.uk":"2","co.jp":"9","com":"1","it":"35691","es":"44551"};var at_impression_recorders={"ca":"www.assoc-amazon.ca","cn":"www.assoc-amazon.cn","in":"ir-in.amazon-adsystem.com","de":"www.assoc-amazon.de","fr":"www.assoc-amazon.fr","co.uk":"www.assoc-amazon.co.uk","co.jp":"www.assoc-amazon.jp","com":"www.assoc-amazon.com","it":"www.assoc-amazon.it","es":"www.assoc-amazon.es"};var at_marketplaces={"CA":new Array(),"CN":new Array(),"IN":new Array(),"DE":new Array("javari"),"FR":new Array("javari"),"GB":new Array("javari"),"JP":new Array("javari"),"US":new Array("smallparts","amazonwireless","endless","myhabit"),"IT":new Array(),"ES":new Array()};var at_timeout=2000;var at_start=new Date();at_start=at_start.getTime();var at_tagID;var at_localeID;var at_overWrite;var at_code='as2';var at_scripts=document.getElementsByTagName('script');for(var i=0;i<at_scripts.length;i++){var source=new String(at_scripts[i].src);var at_tagIDObj;if(at_tagIDObj=source.match(/auto-tagger.*[&?]tag=([^&]+)/)){at_tagID=at_tagIDObj[1]}
if(at_tagIDObj=source.match(/auto-tagger.*[&?]locale=([^&]+)/)){at_localeID=at_tagIDObj[1]}
if(at_tagIDObj=source.match(/auto-tagger.*[&?]overwrite=([\d])/)){at_overWrite=at_tagIDObj[1];break}}
if(at_overWrite=="1"){at_overWrite=parseInt(at_overWrite)}else{at_overWrite=0}
var at_locale=at_amazon_locale_map[at_localeID];var marketplace_urls=at_marketplaces[at_localeID];var at_amazon=new RegExp("^(http|https)://(www|[\\w\\-\\.]+)?amazon\\.("+at_locale+")/","i");var marketplaceList=new Array();var marketplaceListIndex=0;if(marketplace_urls){for(marketplaceListIndex=0;marketplaceListIndex<marketplace_urls.length;marketplaceListIndex++){var mkt_locale=at_locale;if(at_locale=="co.jp"){mkt_locale="co.jp|jp"}
marketplaceList[marketplaceListIndex]=new RegExp("^(http|https)://(www\\.)?("+marketplace_urls[marketplaceListIndex]+")\\.("+mkt_locale+")/","i")}}
var at_allLinks=document.getElementsByTagName('a');var at_imp={};var at_timeoutReached=!1;var at_amazonTreatment=!1;var at_agent=new String(navigator.userAgent);if(at_agent.match(/(MSIE.*Windows|Firefox|Netscape|Windows.*Gecko|Safari\/)/)){at_amazonTreatment=!0}
var at_amazonLinkList=new Array;for(var i=0;i<at_allLinks.length;i++){var href=new String(at_allLinks[i].href);var results;var tag_match;var doReplace=!1;tag_match=href.match(/tag=([^&]+)/);if((results=href.match(at_amazon))){at_amazonLinkList[i]=at_allLinks[i].href;var locale=results[3];var org=at_orgUnit[locale];if(at_amazonTreatment){if(tag_match){if(at_overWrite){at_amazon_enhanceLink(at_allLinks[i],at_tagID,at_code);at_imp=at_amazon_logImpression(at_allLinks[i],at_imp,locale,at_tagID)}}else{at_amazon_enhanceLink(at_allLinks[i],at_tagID,at_code);at_imp=at_amazon_logImpression(at_allLinks[i],at_imp,locale,at_tagID)}}}else{for(var regExNum=0;regExNum<marketplaceList.length;regExNum++){if(results=href.match(marketplaceList[regExNum])){if(tag_match){if(at_overWrite){at_amazon_enhanceLink(at_allLinks[i],at_tagID,at_code);at_imp=at_amazon_logImpression(at_allLinks[i],at_imp,at_locale,at_tagID)}}else{at_amazon_enhanceLink(at_allLinks[i],at_tagID,at_code);at_imp=at_amazon_logImpression(at_allLinks[i],at_imp,at_locale,at_tagID)}}}}
var now=new Date();now=now.getTime();if(now>(at_start+at_timeout)){at_timeoutReached=!0;break}}
var at_total=0;for(var locale in at_imp){var impression_recorder=at_impression_recorders[locale];for(var tag in at_imp[locale]){var tc=(at_amazonTreatment)?'at3':'pv2';document.write('<img src="'+window.location.protocol+'//'+impression_recorder+'/e/ir'+'?l='+tc+'&t='+at_tagID+'&o='+at_orgUnit[locale]+'" />');var link_at_code='at1';link_at_code=link_at_code.replace(/^-/,'');document.write('<img src="'+window.location.protocol+'//'+impression_recorder+'/e/ir'+'?t='+at_tagID+'&l='+link_at_code+'&o='+at_orgUnit[locale]+'&i='+at_imp[locale][at_tagID]+'" />');at_total+=at_imp[locale][at_tagID]}}
if(at_timeoutReached){document.write('<img src="'+window.location.protocol+'//'+at_impression_recorders[locale]+'/e/ir?t='+at_tagID+'&l=to0&o='+at_orgUnit[locale]+'&i='+at_total+'" />')}}
function at_amazon_InsertLinkCode(href,at_code){return href}
function at_amazon_logImpression(link,at_imp,locale,tag,count){var lk=link.href;if(!count){count=1}
if(at_imp[locale]){if(at_imp[locale][tag]){if(at_imp[locale][tag]){at_imp[locale][tag]=at_imp[locale][tag]+count}else{at_imp[locale][tag]=count}}else{at_imp[locale][tag]={};at_imp[locale][tag]=count}}else{at_imp[locale]={};at_imp[locale][tag]={};at_imp[locale][tag]=count}
return at_imp}
function at_amazon_enhanceLink(link,tag,at_code){var hasQuery=new RegExp("[?]","i");var hasSlash=new RegExp("\/$")
var ref_match=new RegExp("\/(ref=[\\w]+)\/\?","i");if(!link.name){var tag_match=link.href.match(/tag=([^&]+)/);var tag_param=link.href.match(/tag=/);var linkCode_match=link.href.match(/linkCode=([^&]+)/);if(!link.href.match(hasQuery)){link.href=(link.href.match(hasSlash))?link.href+"?":link.href+"/?"}
if(linkCode_match){link.href=link.href.replace(linkCode_match[1],linkCode_match[1])}else{link.href=link.href.replace(/\?/,'?linkCode='+at_code+'&')}
if(tag_match){link.href=link.href.replace(tag_match[1],tag)}else if(tag_param){link.href=link.href.replace(/tag=/,'tag='+tag)}else{link.href=link.href.replace(/\?/,'?tag='+tag+'&')}
var match;if(match=link.href.match(ref_match)){link.href=link.href.replace(match[1],'ref=as_at')}else{link.href=link.href.replace(/\/\?/,'/ref=as_at?')}}}})()